{"version":3,"file":"index.js","sources":["dev/index.js"],"sourcesContent":["window.addEventListener('load', () => {\n    function getSongs() {\n        const $list = document.querySelector('#g_playlist');\n        if (!$list) return [];\n        const $list_ul = $list.querySelector('.f-cb');\n        return Array.from($list_ul.children).map(item => {\n            return {\n                id: Number(item.dataset.id),\n                playing: item.classList.contains('z-sel'),\n                song: item.children[1].innerText.trim(),\n                singer: item.children[3].innerText,\n                duration: item.children[4].innerText,\n            };\n        });\n    }\n\n    function getLyrics() {\n        const $list = document.querySelector('#g_playlist');\n        if (!$list) return [];\n        const $lyrics = $list.querySelector('.listlyric');\n        return Array.from($lyrics.children).map(item => {\n            return {\n                playing: item.classList.contains('z-sel'),\n                time: item.dataset.time,\n                text: item.innerText.trim(),\n            };\n        });\n    }\n\n    setInterval(() => {\n        const $listBtn = document.querySelector('[title=\"播放列表\"]');\n        const $list = document.querySelector('#g_playlist');\n        if (!$list && $listBtn) {\n            $listBtn.click();\n        } else {\n            window.parent.postMessage(\n                {\n                    type: 'MUSIC_163',\n                    data: {\n                        songs: getSongs(),\n                        lyrics: getLyrics(),\n                    },\n                },\n                '*',\n            );\n        }\n    }, 1000);\n\n    function order_song(song) {\n        const $iframe = document.querySelector('#g_iframe');\n        const $input = $iframe.contentDocument.querySelector('#m-search-input');\n        const $search = $iframe.contentDocument.querySelector('[title=\"搜索\"]');\n        $input.value = song;\n        $search.click();\n        setTimeout(() => {\n            const $add = $iframe.contentDocument.querySelector('[title=\"添加到播放列表\"');\n            if ($add) {\n                $add.click();\n            }\n        }, 1000);\n    }\n\n    function prev_song() {\n        const $prev = document.querySelector('.prv');\n        $prev.click();\n    }\n\n    function next_song() {\n        const $next = document.querySelector('.nxt');\n        $next.click();\n    }\n\n    function play_song(state) {\n        const $play = document.querySelector('.ply');\n        const playing = $play.dataset.action === 'pause';\n        if ((playing && state) || (!playing && !state)) return;\n        if ((playing && !state) || (!playing && state)) $play.click();\n    }\n\n    function play_mode(mode) {\n        if (!['one', 'loop', 'shuffle'].includes(mode)) return;\n        const $mode = document.querySelector('[data-action=\"mode\"]');\n        (function check() {\n            if (!$mode.classList.contains(`icn-${mode}`)) {\n                $mode.click();\n                setTimeout(check, 100);\n            }\n        })();\n    }\n\n    function clear_song() {\n        const $clear = document.querySelector('.clear');\n        $clear.click();\n    }\n\n    window.addEventListener('message', event => {\n        const { type, data } = event.data;\n        switch (type) {\n            case 'ORDER_SONG':\n                order_song(data);\n                break;\n            case 'PREV_SONG':\n                prev_song();\n                break;\n            case 'NEXT_SONG':\n                next_song();\n                break;\n            case 'PLAY_SONG':\n                play_song(true);\n                break;\n            case 'PAUSE_SONG':\n                play_song(false);\n                break;\n            case 'PLAY_MODE':\n                play_mode(data);\n                break;\n            case 'CLEAR_SONG':\n                clear_song();\n                break;\n            case 'RELOAD':\n                window.location.reload();\n                break;\n            default:\n                break;\n        }\n    });\n});\n"],"names":["window","addEventListener","getSongs","$list","document","querySelector","$list_ul","Array","from","children","map","item","id","Number","dataset","playing","classList","contains","song","innerText","trim","singer","duration","getLyrics","$lyrics","time","text","setInterval","$listBtn","click","parent","postMessage","type","data","songs","lyrics","order_song","$iframe","$input","contentDocument","$search","value","setTimeout","$add","prev_song","$prev","next_song","$next","play_song","state","$play","action","play_mode","mode","includes","$mode","check","clear_song","$clear","event","location","reload"],"mappings":"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"}