{"version":3,"file":"index.js","sources":["../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/classCallCheck.js","../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/createClass.js","../share/constant.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","export const START = 'START';\nexport const STOP = 'STOP';\nexport const DANMU = 'DANMU';\nexport const GIFT = 'GIFT';\n","import { DANMU, GIFT } from '../../share/constant';\n\nclass Injected {\n    constructor() {\n        this.getPlayer().then(player => {\n            Object.defineProperty(player, 'getVisibilityStatus', {\n                value: () => true,\n            });\n\n            const { addDanmaku } = player;\n            player.addDanmaku = function f(...arg) {\n                const result = addDanmaku.call(this, ...arg);\n                window.postMessage({\n                    type: DANMU,\n                    data: arg[0],\n                });\n                return result;\n            };\n        });\n\n        this.getChatHistoryList().then(chatHistoryList => {\n            console.log(chatHistoryList);\n        });\n\n        this.getPenuryGiftMsg().then(penuryGiftMsg => {\n            console.log(penuryGiftMsg);\n        });\n    }\n\n    getPlayer() {\n        return new Promise(resolve => {\n            (function loop() {\n                if (!window.EmbedPlayer || !window.EmbedPlayer.playerInstance) {\n                    setTimeout(loop, 1000);\n                } else if (window.EmbedPlayer.playerInstance.play) {\n                    const instance = window.EmbedPlayer.playerInstance.play();\n                    resolve(instance);\n                } else {\n                    setTimeout(loop, 1000);\n                }\n            })();\n        });\n    }\n\n    getChatHistoryList() {\n        return new Promise(resolve => {\n            (function loop() {\n                const chatHistoryList = document.getElementById('chat-history-list');\n                if (!chatHistoryList) {\n                    setTimeout(loop, 1000);\n                } else {\n                    resolve(chatHistoryList);\n                }\n            })();\n        });\n    }\n\n    getPenuryGiftMsg() {\n        return new Promise(resolve => {\n            (function loop() {\n                const penuryGiftMsg = document.getElementById('penury-gift-msg');\n                if (!penuryGiftMsg) {\n                    setTimeout(loop, 1000);\n                } else {\n                    resolve(penuryGiftMsg);\n                }\n            })();\n        });\n    }\n}\n\nexport default new Injected();\n"],"names":["DANMU","Injected","getPlayer","then","player","Object","defineProperty","value","addDanmaku","f","arg","result","call","window","postMessage","type","data","getChatHistoryList","chatHistoryList","console","log","getPenuryGiftMsg","penuryGiftMsg","Promise","resolve","loop","EmbedPlayer","playerInstance","setTimeout","play","instance","document","getElementById"],"mappings":"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"}