/*!
 * bilibili-live-hime v1.0.1
 * Github: https://github.com/zhw2590582/bilibili-live-hime
 * (c) 2018-2019 Harvey Zack
 * Released under the MIT License.
 */

var BilibiliLiveHimeActive=function(){"use strict";var e=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};var o=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(i){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?e.exports=n=function(e){return t(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},n(i)}e.exports=n}));!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==o(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}({22:function(e,t,n){window.DanmakuWebSocket=n(25)},25:function(e,t){var n,i;n="undefined"!=typeof self?self:this,i=function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){t.a={WS_OP_HEARTBEAT:2,WS_OP_HEARTBEAT_REPLY:3,WS_OP_MESSAGE:5,WS_OP_USER_AUTHENTICATION:7,WS_OP_CONNECT_SUCCESS:8,WS_PACKAGE_HEADER_TOTAL_LENGTH:16,WS_PACKAGE_OFFSET:0,WS_HEADER_OFFSET:4,WS_VERSION_OFFSET:6,WS_OPERATION_OFFSET:8,WS_SEQUENCE_OFFSET:12,WS_BODY_PROTOCOL_VERSION_NORMAL:0,WS_BODY_PROTOCOL_VERSION_DEFLATE:2,WS_HEADER_DEFAULT_VERSION:1,WS_HEADER_DEFAULT_OPERATION:1,WS_HEADER_DEFAULT_SEQUENCE:1,WS_AUTH_OK:0,WS_AUTH_TOKEN_ERROR:-101}},function(e,t,n){var i=n(2).default;e.exports=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"development"===e.CONFIG.bundleType&&(console.clear(),console.dir(e.CONFIG)),this.initialize(t)}return e.prototype.initialize=function(t){return"development"===e.CONFIG.bundleType&&console.log("App Initialized."),this.ws=new i.a(t),this.getReturn()},e.prototype.getReturn=function(){return"development"===e.CONFIG.bundleType?this:{destroy:this.destroy.bind(this),send:this.send.bind(this),getAuthInfo:this.getAuthInfo.bind(this),getRetryCount:this.getRetryCount.bind(this)}},e.prototype.destroy=function(){this.ws&&this.ws.destroy()},e.prototype.send=function(e){this.ws&&this.ws.send(e)},e.prototype.getAuthInfo=function(){return this.ws&&this.ws.getAuthInfo()},e.prototype.getRetryCount=function(){return this.ws&&this.ws.getRetryCount()},o(e,null,[{key:"CONFIG",get:function(){return{version:"1.3.4",gitHash:"151ab1a1",build:"27",bundleType:"release"}}}]),e}();t.default=r},function(e,t,n){var i=n(0),o=n(4),r=n(5),a=n(6).inflate,s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.checkOptions(t)){var n={url:"",urlList:[],rid:0,aid:0,uid:0,from:-1,retry:!0,retryMaxCount:0,retryInterval:5,retryThreadCount:10,retryRoundInterval:Math.floor(2*Math.random())+3,customAuthParam:[],fallback:function(){},heartBeatInterval:30,onReceivedMessage:function(){},onReceiveAuthRes:function(){},onHeartBeatReply:function(){},onInitialized:function(){},onOpen:function(){},onClose:function(){},onError:function(){},onListConnectError:function(){}};this.options=r.a.extend({},n,t),this.wsBinaryHeaderList=r.a.extend([],o.a),this.authInfo={origin:"",encode:""},0!==this.options.urlList.length&&0!==this.options.retryMaxCount&&this.options.retryMaxCount<this.options.urlList.length&&(this.options.retryMaxCount=this.options.urlList.length-1),this.state={retryCount:0,listConnectFinishedCount:0,index:0},this.callbackQueueList={onInitializedQueue:[],onOpenQueue:[],onCloseQueue:[],onErrorQueue:[],onReceivedMessageQueue:[],onHeartBeatReplyQueue:[],onRetryFallbackQueue:[],onListConnectErrorQueue:[],onReceiveAuthResQueue:[]},this.HEART_BEAT_INTERVAL=0,this.mixinCallback().initialize(this.options.urlList.length>0?this.options.urlList[0]:this.options.url)}}return e.prototype.initialize=function(e){var t="MozWebSocket"in window?window.MozWebSocket:window.WebSocket,n=this.options;try{this.ws=new t(e),this.ws.binaryType="arraybuffer",this.ws.onopen=this.onOpen.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onclose=this.onClose.bind(this),this.ws.onerror=this.onError.bind(this),r.a.callFunction(this.callbackQueueList.onInitializedQueue),this.callbackQueueList.onInitializedQueue=[]}catch(e){"function"==typeof n.fallback&&n.fallback()}return this},e.prototype.onOpen=function(){return r.a.callFunction(this.callbackQueueList.onOpenQueue),this.userAuthentication(),this},e.prototype.userAuthentication=function(){var e,t=this,n=this.options,o={uid:parseInt(n.uid,10),roomid:parseInt(n.rid,10),protover:parseInt(n.protover,10)||i.a.WS_BODY_PROTOCOL_VERSION_NORMAL};n.aid&&(o.aid=parseInt(n.aid,10)),n.from>0&&(o.from=parseInt(n.from,10)||7);for(var r=0;r<n.customAuthParam.length;r++){var a=n.customAuthParam[r],s=a.type||"string";switch(void 0!==o[a.key]&&console.error("Token has the same key already! 【"+a.key+"】"),a.key.toString()&&a.value.toString()||console.error("Invalid customAuthParam, missing key or value! 【"+a.key+"】-【"+a.value+"】"),s){case"string":o[a.key]=a.value;break;case"number":o[a.key]=parseInt(a.value,10);break;case"boolean":o[a.key]=!!o[a.value];break;default:return void console.error("Unsupported customAuthParam type!【"+s+"】")}}e=this.convertToArrayBuffer(JSON.stringify(o),i.a.WS_OP_USER_AUTHENTICATION),this.authInfo.origin=o,this.authInfo.encode=e,setTimeout((function(){t.ws.send(e)}),0)},e.prototype.getAuthInfo=function(){return this.authInfo},e.prototype.heartBeat=function(){var e=this;clearTimeout(this.HEART_BEAT_INTERVAL);var t=this.convertToArrayBuffer({},i.a.WS_OP_HEARTBEAT);this.ws.send(t),this.HEART_BEAT_INTERVAL=setTimeout((function(){e.heartBeat()}),1e3*this.options.heartBeatInterval)},e.prototype.onMessage=function(e){var t=this;try{var n=this.convertToObject(e.data);if(n instanceof Array)n.forEach((function(e){t.onMessage(e)}));else if(n instanceof Object)switch(n.op){case i.a.WS_OP_HEARTBEAT_REPLY:this.onHeartBeatReply(n.body);break;case i.a.WS_OP_MESSAGE:this.onMessageReply(n.body);break;case i.a.WS_OP_CONNECT_SUCCESS:if(0!==n.body.length&&n.body[0])switch(n.body[0].code){case i.a.WS_AUTH_OK:this.heartBeat();break;case i.a.WS_AUTH_TOKEN_ERROR:this.options.retry=!1,"function"==typeof this.options.onReceiveAuthRes&&this.options.onReceiveAuthRes(n.body);break;default:this.onClose()}else this.heartBeat()}}catch(e){console.error("WebSocket Error: ",e)}return this},e.prototype.onMessageReply=function(e){var t=this;try{e instanceof Array?e.forEach((function(e){t.onMessageReply(e)})):e instanceof Object&&"function"==typeof this.options.onReceivedMessage&&this.options.onReceivedMessage(e)}catch(e){console.error("On Message Resolve Error: ",e)}},e.prototype.onHeartBeatReply=function(e){r.a.callFunction(this.callbackQueueList.onHeartBeatReplyQueue,e)},e.prototype.onClose=function(){var e=this,t=this.options.urlList.length;return r.a.callFunction(this.callbackQueueList.onCloseQueue),clearTimeout(this.HEART_BEAT_INTERVAL),this.options.retry?(this.checkRetryState()?setTimeout((function(){console.error("Danmaku Websocket Retry .",e.state.retryCount),e.state.index+=1,0===t||e.state.retryCount>e.options.retryThreadCount?setTimeout((function(){e.initialize(e.options.url)}),1e3*e.options.retryRoundInterval):0!==t&&e.state.index>t-1?(e.state.index=0,e.state.listConnectFinishedCount+=1,1===e.state.listConnectFinishedCount&&r.a.callFunction(e.callbackQueueList.onListConnectErrorQueue),setTimeout((function(){e.initialize(e.options.urlList[e.state.index])}),1e3*e.options.retryRoundInterval)):e.initialize(e.options.urlList[e.state.index])}),1e3*this.options.retryInterval):(console.error("Danmaku Websocket Retry Failed."),r.a.callFunction(this.callbackQueueList.onRetryFallbackQueue)),this):this},e.prototype.onError=function(e){return console.error("Danmaku Websocket On Error.",e),r.a.callFunction(this.callbackQueueList.onErrorQueue,e),this},e.prototype.destroy=function(){clearTimeout(this.HEART_BEAT_INTERVAL),this.options.retry=!1,this.ws&&this.ws.close(),this.ws=null},e.prototype.convertToArrayBuffer=function(e,t){this.encoder||(this.encoder=r.a.getEncoder());var n=new ArrayBuffer(i.a.WS_PACKAGE_HEADER_TOTAL_LENGTH),o=new DataView(n,i.a.WS_PACKAGE_OFFSET),a=this.encoder.encode(e);return o.setInt32(i.a.WS_PACKAGE_OFFSET,i.a.WS_PACKAGE_HEADER_TOTAL_LENGTH+a.byteLength),this.wsBinaryHeaderList[2].value=t,this.wsBinaryHeaderList.forEach((function(e){4===e.bytes?o.setInt32(e.offset,e.value):2===e.bytes&&o.setInt16(e.offset,e.value)})),r.a.mergeArrayBuffer(n,a)},e.prototype.convertToObject=function(e){var t=new DataView(e),n={body:[]};if(n.packetLen=t.getInt32(i.a.WS_PACKAGE_OFFSET),this.wsBinaryHeaderList.forEach((function(e){4===e.bytes?n[e.key]=t.getInt32(e.offset):2===e.bytes&&(n[e.key]=t.getInt16(e.offset))})),n.packetLen<e.byteLength&&this.convertToObject(e.slice(0,n.packetLen)),this.decoder||(this.decoder=r.a.getDecoder()),!n.op||i.a.WS_OP_MESSAGE!==n.op&&n.op!==i.a.WS_OP_CONNECT_SUCCESS)n.op&&i.a.WS_OP_HEARTBEAT_REPLY===n.op&&(n.body={count:t.getInt32(i.a.WS_PACKAGE_HEADER_TOTAL_LENGTH)});else for(var o=i.a.WS_PACKAGE_OFFSET,s=n.packetLen,u="",c="";o<e.byteLength;o+=s){s=t.getInt32(o),u=t.getInt16(o+i.a.WS_HEADER_OFFSET);try{if(n.ver===i.a.WS_BODY_PROTOCOL_VERSION_DEFLATE){var l=e.slice(o+u,o+s),f=a(new Uint8Array(l));c=this.convertToObject(f.buffer).body}else{var d=this.decoder.decode(e.slice(o+u,o+s));c=0!==d.length?JSON.parse(d):null}c&&n.body.push(c)}catch(t){console.error("decode body error:",new Uint8Array(e),n,t)}}return n},e.prototype.send=function(e){this.ws&&this.ws.send(e)},e.prototype.addCallback=function(e,t){return"function"==typeof e&&t instanceof Array&&t.push(e),this},e.prototype.mixinCallback=function(){var e=this.options,t=this.callbackQueueList;return this.addCallback(e.onReceivedMessage,t.onReceivedMessageQueue).addCallback(e.onHeartBeatReply,t.onHeartBeatReplyQueue).addCallback(e.onInitialized,t.onInitializedQueue).addCallback(e.onOpen,t.onOpenQueue).addCallback(e.onClose,t.onCloseQueue).addCallback(e.onError,t.onErrorQueue).addCallback(e.onRetryFallback,t.onRetryFallbackQueue).addCallback(e.onListConnectError,t.onListConnectErrorQueue).addCallback(e.onReceiveAuthRes,t.onReceiveAuthResQueue),this},e.prototype.getRetryCount=function(){return this.state.retryCount},e.prototype.checkRetryState=function(){var e=this.options,t=!1;return(0===e.retryMaxCount||this.state.retryCount<e.retryMaxCount)&&(this.state.retryCount+=1,t=!0),t},e.checkOptions=function(e){return e||e instanceof Object?e.url?!!e.rid||(console.error("WebSocket Initialize options rid(cid) missing."),!1):(console.error("WebSocket Initialize options url missing."),!1):(console.error("WebSocket Initialize options missing or error.",e),!1)},e}();t.a=s},function(e,t,n){var i=n(0),o=[{name:"Header Length",key:"headerLen",bytes:2,offset:i.a.WS_HEADER_OFFSET,value:i.a.WS_PACKAGE_HEADER_TOTAL_LENGTH},{name:"Protocol Version",key:"ver",bytes:2,offset:i.a.WS_VERSION_OFFSET,value:i.a.WS_HEADER_DEFAULT_VERSION},{name:"Operation",key:"op",bytes:4,offset:i.a.WS_OPERATION_OFFSET,value:i.a.WS_HEADER_DEFAULT_OPERATION},{name:"Sequence Id",key:"seq",bytes:4,offset:i.a.WS_SEQUENCE_OFFSET,value:i.a.WS_HEADER_DEFAULT_SEQUENCE}];t.a=o},function(e,t,n){var i={getDecoder:function(){return window.TextDecoder?new window.TextDecoder:{decode:function(e){return decodeURIComponent(window.escape(String.fromCharCode.apply(String,new Uint8Array(e))))}}},getEncoder:function(){return window.TextEncoder?new window.TextEncoder:{encode:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0,o=e.length;i<o;i++)n[i]=e.charCodeAt(i);return t}}},mergeArrayBuffer:function(e,t){var n=new Uint8Array(e),i=new Uint8Array(t),o=new Uint8Array(n.byteLength+i.byteLength);return o.set(n,0),o.set(i,n.byteLength),o.buffer},callFunction:function(e,t){return e instanceof Array&&e.length?(e.forEach((function(e){return"function"==typeof e&&e(t)})),null):"function"==typeof e&&e(t)},extend:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o=e||{};return o instanceof Object&&n.forEach((function(e){e instanceof Object&&Object.keys(e).forEach((function(t){o[t]=e[t]}))})),o}};t.a=i},function(e,t,n){var i;e.exports=function e(t,n,o){function r(s,u){if(!n[s]){if(!t[s]){if(!u&&"function"==typeof i&&i)return i();if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){return r(t[s][1][e]||e)}),l,l.exports,e,t,n,o)}return n[s].exports}for(var a="function"==typeof i,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t,n,i=Array.prototype.slice.call(arguments,1);i.length;){var r=i.shift();if(r){if("object"!=o(r))throw new TypeError(r+"must be non-object");for(var a in r)t=r,n=a,Object.prototype.hasOwnProperty.call(t,n)&&(e[a]=r[a])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),o);else for(var r=0;r<i;r++)e[o+r]=t[n+r]},flattenChunks:function(e){var t,n,i,o,r,a;for(t=i=0,n=e.length;t<n;t++)i+=e[t].length;for(a=new Uint8Array(i),t=o=0,n=e.length;t<n;t++)r=e[t],a.set(r,o),o+=r.length;return a}},a={arraySet:function(e,t,n,i,o){for(var r=0;r<i;r++)e[o+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},{}],2:[function(e,t,n){function i(e,t){if(t<65534&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,o.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}var o=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var s=new o.Buf8(256),u=0;u<256;u++)s[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;s[254]=s[254]=1,n.string2buf=function(e){var t,n,i,r,a,s=e.length,u=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),u+=n<128?1:n<2048?2:n<65536?3:4;for(t=new o.Buf8(u),r=a=0;a<u;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),t[a++]=n<128?n:(t[a++]=n<2048?192|n>>>6:(t[a++]=n<65536?224|n>>>12:(t[a++]=240|n>>>18,128|n>>>12&63),128|n>>>6&63),128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new o.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,o,r,a,u=t||e.length,c=new Array(2*u);for(n=o=0;n<u;)if((r=e[n++])<128)c[o++]=r;else if(4<(a=s[r]))c[o++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&n<u;)r=r<<6|63&e[n++],a--;c[o++]=1<a?65533:r<65536?r:(r-=65536,c[o++]=55296|r>>10&1023,56320|1023&r)}return i(c,o)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+s[e[n]]>t?n:t}},{"./common":1}],3:[function(e,t,n){t.exports=function(e,t,n,i){for(var o=65535&e|0,r=e>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;r=r+(o=o+t[i++]|0)|0,--a;);o%=65521,r%=65521}return o|r<<16|0}},{}],4:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,n){var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,o){var r=i,a=o+n;e^=-1;for(var s=o;s<a;s++)e=e>>>8^r[255&(e^t[s])];return-1^e}},{}],6:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(e,t,n){t.exports=function(e,t){var n,i,o,r,a,s,u,c,l,f,d,h,b,m,p,y,_,v,k,g,w,E,S,A,O;n=e.state,i=e.next_in,A=e.input,o=i+(e.avail_in-5),r=e.next_out,O=e.output,a=r-(t-e.avail_out),s=r+(e.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,f=n.wnext,d=n.window,h=n.hold,b=n.bits,m=n.lencode,p=n.distcode,y=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{b<15&&(h+=A[i++]<<b,b+=8,h+=A[i++]<<b,b+=8),v=m[h&y];t:for(;;){if(h>>>=k=v>>>24,b-=k,0==(k=v>>>16&255))O[r++]=65535&v;else{if(!(16&k)){if(0==(64&k)){v=m[(65535&v)+(h&(1<<k)-1)];continue t}if(32&k){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}g=65535&v,(k&=15)&&(b<k&&(h+=A[i++]<<b,b+=8),g+=h&(1<<k)-1,h>>>=k,b-=k),b<15&&(h+=A[i++]<<b,b+=8,h+=A[i++]<<b,b+=8),v=p[h&_];n:for(;;){if(h>>>=k=v>>>24,b-=k,!(16&(k=v>>>16&255))){if(0==(64&k)){v=p[(65535&v)+(h&(1<<k)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&v,b<(k&=15)&&(h+=A[i++]<<b,(b+=8)<k&&(h+=A[i++]<<b,b+=8)),u<(w+=h&(1<<k)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=k,b-=k,(k=r-a)<w){if(l<(k=w-k)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=d,(E=0)===f){if(E+=c-k,k<g){for(g-=k;O[r++]=d[E++],--k;);E=r-w,S=O}}else if(f<k){if(E+=c+f-k,(k-=f)<g){for(g-=k;O[r++]=d[E++],--k;);if(E=0,f<g){for(g-=k=f;O[r++]=d[E++],--k;);E=r-w,S=O}}}else if(E+=f-k,k<g){for(g-=k;O[r++]=d[E++],--k;);E=r-w,S=O}for(;2<g;)O[r++]=S[E++],O[r++]=S[E++],O[r++]=S[E++],g-=3;g&&(O[r++]=S[E++],1<g&&(O[r++]=S[E++]))}else{for(E=r-w;O[r++]=O[E++],O[r++]=O[E++],O[r++]=O[E++],2<(g-=3););g&&(O[r++]=O[E++],1<g&&(O[r++]=O[E++]))}break}}break}}while(i<o&&r<s);i-=g=b>>3,h&=(1<<(b-=g<<3))-1,e.next_in=i,e.next_out=r,e.avail_in=i<o?o-i+5:5-(i-o),e.avail_out=r<s?s-r+257:257-(r-s),n.hold=h,n.bits=b}},{}],8:[function(e,t,n){function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=g,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new d.Buf32(w),t.distcode=t.distdyn=new d.Buf32(E),t.sane=1,t.back=-1,v):k}function r(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,o(e)):k}function a(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?k:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,r(e))):k}function s(e,t){var n,i;return e?(i=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},(e.state=i).window=null,(n=a(e,t))!==v&&(e.state=null),n):k}function u(e){if(S){var t;for(l=new d.Buf32(512),f=new d.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(p(y,e.lens,0,288,l,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;p(_,e.lens,0,32,f,0,e.work,{bits:5}),S=!1}e.lencode=l,e.lenbits=9,e.distcode=f,e.distbits=5}function c(e,t,n,i){var o,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new d.Buf8(r.wsize)),i>=r.wsize?(d.arraySet(r.window,t,n-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(i<(o=r.wsize-r.wnext)&&(o=i),d.arraySet(r.window,t,n-i,o,r.wnext),(i-=o)?(d.arraySet(r.window,t,n-i,i,0),r.wnext=i,r.whave=r.wsize):(r.wnext+=o,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=o))),0}var l,f,d=e("../utils/common"),h=e("./adler32"),b=e("./crc32"),m=e("./inffast"),p=e("./inftrees"),y=1,_=2,v=0,k=-2,g=1,w=852,E=592,S=!0;n.inflateReset=r,n.inflateReset2=a,n.inflateResetKeep=o,n.inflateInit=function(e){return s(e,15)},n.inflateInit2=s,n.inflate=function(e,t){var n,o,r,a,s,l,f,w,E,S,A,O,T,x,R,C,I,L,B,F,N,H,D,P,W=0,U=new d.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return k;12===(n=e.state).mode&&(n.mode=13),s=e.next_out,r=e.output,f=e.avail_out,a=e.next_in,o=e.input,l=e.avail_in,w=n.hold,E=n.bits,S=l,A=f,H=v;e:for(;;)switch(n.mode){case g:if(0===n.wrap){n.mode=13;break}for(;E<16;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(2&n.wrap&&35615===w){U[n.check=0]=255&w,U[1]=w>>>8&255,n.check=b(n.check,U,2,0),E=w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&w)){e.msg="unknown compression method",n.mode=30;break}if(E-=4,N=8+(15&(w>>>=4)),0===n.wbits)n.wbits=N;else if(N>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<N,e.adler=n.check=1,n.mode=512&w?10:12,E=w=0;break;case 2:for(;E<16;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=b(n.check,U,2,0)),E=w=0,n.mode=3;case 3:for(;E<32;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.head&&(n.head.time=w),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,U[2]=w>>>16&255,U[3]=w>>>24&255,n.check=b(n.check,U,4,0)),E=w=0,n.mode=4;case 4:for(;E<16;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=b(n.check,U,2,0)),E=w=0,n.mode=5;case 5:if(1024&n.flags){for(;E<16;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=b(n.check,U,2,0)),E=w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(l<(O=n.length)&&(O=l),O&&(n.head&&(N=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),d.arraySet(n.head.extra,o,a,O,N)),512&n.flags&&(n.check=b(n.check,o,O,a)),l-=O,a+=O,n.length-=O),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===l)break e;for(O=0;N=o[a+O++],n.head&&N&&n.length<65536&&(n.head.name+=String.fromCharCode(N)),N&&O<l;);if(512&n.flags&&(n.check=b(n.check,o,O,a)),l-=O,a+=O,N)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===l)break e;for(O=0;N=o[a+O++],n.head&&N&&n.length<65536&&(n.head.comment+=String.fromCharCode(N)),N&&O<l;);if(512&n.flags&&(n.check=b(n.check,o,O,a)),l-=O,a+=O,N)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;E<16;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}E=w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;E<32;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}e.adler=n.check=i(w),E=w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=l,n.hold=w,n.bits=E,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){w>>>=7&E,E-=7&E,n.mode=27;break}for(;E<3;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}switch(n.last=1&w,E-=1,3&(w>>>=1)){case 0:n.mode=14;break;case 1:if(u(n),n.mode=20,6!==t)break;w>>>=2,E-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}w>>>=2,E-=2;break;case 14:for(w>>>=7&E,E-=7&E;E<32;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&w,E=w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(O=n.length){if(l<O&&(O=l),f<O&&(O=f),0===O)break e;d.arraySet(r,o,a,O,s),l-=O,a+=O,f-=O,s+=O,n.length-=O;break}n.mode=12;break;case 17:for(;E<14;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(n.nlen=257+(31&w),w>>>=5,E-=5,n.ndist=1+(31&w),w>>>=5,E-=5,n.ncode=4+(15&w),w>>>=4,E-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;E<3;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.lens[M[n.have++]]=7&w,w>>>=3,E-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},H=p(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,H){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(W=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,I=65535&W,!((R=W>>>24)<=E);){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(I<16)w>>>=R,E-=R,n.lens[n.have++]=I;else{if(16===I){for(P=R+2;E<P;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(w>>>=R,E-=R,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}N=n.lens[n.have-1],O=3+(3&w),w>>>=2,E-=2}else if(17===I){for(P=R+3;E<P;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}E-=R,N=0,O=3+(7&(w>>>=R)),w>>>=3,E-=3}else{for(P=R+7;E<P;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}E-=R,N=0,O=11+(127&(w>>>=R)),w>>>=7,E-=7}if(n.have+O>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;O--;)n.lens[n.have++]=N}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,D={bits:n.lenbits},H=p(y,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,H){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},H=p(_,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,H){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=l&&258<=f){e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=l,n.hold=w,n.bits=E,m(e,A),s=e.next_out,r=e.output,f=e.avail_out,a=e.next_in,o=e.input,l=e.avail_in,w=n.hold,E=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;C=(W=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,I=65535&W,!((R=W>>>24)<=E);){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(C&&0==(240&C)){for(L=R,B=C,F=I;C=(W=n.lencode[F+((w&(1<<L+B)-1)>>L)])>>>16&255,I=65535&W,!(L+(R=W>>>24)<=E);){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}w>>>=L,E-=L,n.back+=L}if(w>>>=R,E-=R,n.back+=R,n.length=I,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=12;break}if(64&C){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(P=n.extra;E<P;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,E-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(W=n.distcode[w&(1<<n.distbits)-1])>>>16&255,I=65535&W,!((R=W>>>24)<=E);){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(0==(240&C)){for(L=R,B=C,F=I;C=(W=n.distcode[F+((w&(1<<L+B)-1)>>L)])>>>16&255,I=65535&W,!(L+(R=W>>>24)<=E);){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}w>>>=L,E-=L,n.back+=L}if(w>>>=R,E-=R,n.back+=R,64&C){e.msg="invalid distance code",n.mode=30;break}n.offset=I,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(P=n.extra;E<P;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,E-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===f)break e;if(O=A-f,n.offset>O){if((O=n.offset-O)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}T=O>n.wnext?(O-=n.wnext,n.wsize-O):n.wnext-O,O>n.length&&(O=n.length),x=n.window}else x=r,T=s-n.offset,O=n.length;for(f<O&&(O=f),f-=O,n.length-=O;r[s++]=x[T++],--O;);0===n.length&&(n.mode=21);break;case 26:if(0===f)break e;r[s++]=n.length,f--,n.mode=21;break;case 27:if(n.wrap){for(;E<32;){if(0===l)break e;l--,w|=o[a++]<<E,E+=8}if(A-=f,e.total_out+=A,n.total+=A,A&&(e.adler=n.check=n.flags?b(n.check,r,A,s-A):h(n.check,r,A,s-A)),A=f,(n.flags?w:i(w))!==n.check){e.msg="incorrect data check",n.mode=30;break}E=w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;E<32;){if(0===l)break e;l--,w+=o[a++]<<E,E+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}E=w=0}n.mode=29;case 29:H=1;break e;case 30:H=-3;break e;case 31:return-4;case 32:default:return k}return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=l,n.hold=w,n.bits=E,(n.wsize||A!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&c(e,e.output,e.next_out,A-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,A-=e.avail_out,e.total_in+=S,e.total_out+=A,n.total+=A,n.wrap&&A&&(e.adler=n.check=n.flags?b(n.check,r,A,e.next_out-A):h(n.check,r,A,e.next_out-A)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===S&&0===A||4===t)&&H===v&&(H=-5),H)},n.inflateEnd=function(e){if(!e||!e.state)return k;var t=e.state;return t.window&&(t.window=null),e.state=null,v},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?k:((n.head=t).done=!1,v):k},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?k:11===n.mode&&h(1,t,i,0)!==n.check?-3:c(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,v):k},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,n){var i=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,u,c,l,f,d){var h,b,m,p,y,_,v,k,g,w=d.bits,E=0,S=0,A=0,O=0,T=0,x=0,R=0,C=0,I=0,L=0,B=null,F=0,N=new i.Buf16(16),H=new i.Buf16(16),D=null,P=0;for(E=0;E<=15;E++)N[E]=0;for(S=0;S<u;S++)N[t[n+S]]++;for(T=w,O=15;1<=O&&0===N[O];O--);if(O<T&&(T=O),0===O)return c[l++]=20971520,c[l++]=20971520,d.bits=1,0;for(A=1;A<O&&0===N[A];A++);for(T<A&&(T=A),E=C=1;E<=15;E++)if(C<<=1,(C-=N[E])<0)return-1;if(0<C&&(0===e||1!==O))return-1;for(H[1]=0,E=1;E<15;E++)H[E+1]=H[E]+N[E];for(S=0;S<u;S++)0!==t[n+S]&&(f[H[t[n+S]]++]=S);if(_=0===e?(B=D=f,19):1===e?(B=o,F-=257,D=r,P-=257,256):(B=a,D=s,-1),E=A,y=l,R=S=L=0,m=-1,p=(I=1<<(x=T))-1,1===e&&852<I||2===e&&592<I)return 1;for(;;){for(v=E-R,g=f[S]<_?(k=0,f[S]):f[S]>_?(k=D[P+f[S]],B[F+f[S]]):(k=96,0),h=1<<E-R,A=b=1<<x;c[y+(L>>R)+(b-=h)]=v<<24|k<<16|g|0,0!==b;);for(h=1<<E-1;L&h;)h>>=1;if(0!==h?(L&=h-1,L+=h):L=0,S++,0==--N[E]){if(E===O)break;E=t[n+f[S]]}if(T<E&&(L&p)!==m){for(0===R&&(R=T),y+=A,C=1<<(x=E-R);x+R<O&&!((C-=N[x+R])<=0);)x++,C<<=1;if(I+=1<<x,1===e&&852<I||2===e&&592<I)return 1;c[m=L&p]=T<<24|x<<16|y-l|0}}return 0!==L&&(c[y+L]=E-R<<24|64<<16|0),d.bits=T,0}},{"../utils/common":1}],10:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(e,t,n){function i(e){if(!(this instanceof i))return new i(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==u.Z_OK)throw new Error(c[n]);if(this.header=new f,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==u.Z_OK))throw new Error(c[n])}function o(e,t){var n=new i(t);if(n.push(e,!0),n.err)throw n.msg||c[n.err];return n.result}var r=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),u=e("./zlib/constants"),c=e("./zlib/messages"),l=e("./zlib/zstream"),f=e("./zlib/gzheader"),d=Object.prototype.toString;i.prototype.push=function(e,t){var n,i,o,c,l,f=this.strm,h=this.options.chunkSize,b=this.options.dictionary,m=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?u.Z_FINISH:u.Z_NO_FLUSH,"string"==typeof e?f.input=s.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new a.Buf8(h),f.next_out=0,f.avail_out=h),(n=r.inflate(f,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&b&&(n=r.inflateSetDictionary(this.strm,b)),n===u.Z_BUF_ERROR&&!0===m&&(n=u.Z_OK,m=!1),n!==u.Z_STREAM_END&&n!==u.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==u.Z_STREAM_END&&(0!==f.avail_in||i!==u.Z_FINISH&&i!==u.Z_SYNC_FLUSH)||("string"===this.options.to?(o=s.utf8border(f.output,f.next_out),c=f.next_out-o,l=s.buf2string(f.output,o),f.next_out=c,f.avail_out=h-c,c&&a.arraySet(f.output,f.output,o,c,0),this.onData(l)):this.onData(a.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==u.Z_STREAM_END);return n===u.Z_STREAM_END&&(i=u.Z_FINISH),i===u.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u.Z_OK):i!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(f.avail_out=0))},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){e===u.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=i,n.inflate=o,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},n.ungzip=o},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}])},"object"==o(t)&&"object"==o(e)?e.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==o(t)?t.DanmakuWebSocket=i():n.DanmakuWebSocket=i()}});var r="danmu_option";function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelector(e)}return new(function(){function n(){var i=this;t(this,n),chrome.runtime.onMessage.addListener((function(t){if(!s(".blh-danmuku")){var n=t.type,o=t.data;switch(n){case r:i.dws=new window.DanmakuWebSocket(function(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?a(Object(i),!0).forEach((function(n){e(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},o,{onInitialized:function(){s(".blh-danmuku")||(i.createUI(),i.eventBind())},onReceivedMessage:function(e){window.postMessage(e),i.receivedMessage(e)}}))}}}))}return i(n,[{key:"receivedMessage",value:function(e){var t=e.cmd,n=e.info,i=e.data;switch(t){case"DANMU_MSG":this.addDanmu({uname:n[2][1],text:n[1]});break;case"SEND_GIFT":this.addGift({uname:i.uname,action:i.action,gift:i.giftName,num:i.num});break;case"GUARD_BUY":this.addGift({uname:i.username,action:"购买",gift:i.gift_name,num:i.num});break;default:console.log(e)}}},{key:"createUI",value:function(){this.manifest=chrome.runtime.getManifest(),this.$danmuku=document.createElement("div"),this.$danmuku.classList.add("blh-danmuku"),this.$danmuku.innerHTML='\n            <div class="blh-header">\n                <div class="blh-header-l"></div>\n                <div class="blh-header-r">×</div>\n            </div>\n            <div class="blh-danmu">\n                <div class="blh-danmu-inner"></div>\n            </div>\n            <div class="blh-gift">\n                <div class="blh-gift-inner"></div>\n            </div>\n            <div class="blh-footer"></div>\n        ',this.$headL=s(".blh-header-l",this.$danmuku),this.$headR=s(".blh-header-r",this.$danmuku),this.$danmu=s(".blh-danmu",this.$danmuku),this.$danmuInner=s(".blh-danmu-inner",this.$danmuku),this.$gift=s(".blh-gift",this.$danmuku),this.$giftInner=s(".blh-gift-inner",this.$danmuku),this.$footer=s(".blh-footer",this.$danmuku),this.$headL.textContent="".concat(this.manifest.name," ").concat(this.manifest.version),document.body.appendChild(this.$danmuku),this.$icon=document.createElement("div"),this.$icon.classList.add("blh-danmuku-icon"),this.$icon.textContent="弹",document.body.appendChild(this.$icon)}},{key:"eventBind",value:function(){var e=this,t=!1,n=!1,i=0,o=0,r=0,a=0,s=0;this.$headL.addEventListener("mousedown",(function(n){t=!0,i=n.pageX,o=n.pageY,r=e.$danmuku.offsetLeft,a=e.$danmuku.offsetTop})),this.$footer.addEventListener("mousedown",(function(t){n=!0,o=t.pageY,s=e.$danmu.clientHeight})),document.addEventListener("mousemove",(function(r){if(t){var a=r.pageX-i,u=r.pageY-o;e.$danmuku.style.transform="translate(".concat(a,"px, ").concat(u,"px)")}if(n){var c=s+r.pageY-o;c>=100?e.$danmu.style.height="".concat(c,"px"):n=!1}r.composedPath().indexOf(e.$danmuku)>-1?e.isHover=!0:e.isHover=!1})),document.addEventListener("mouseup",(function(s){if(t){t=!1,e.$danmuku.style.transform="translate(0, 0)";var u=r+s.pageX-i,c=a+s.pageY-o;e.$danmuku.style.left="".concat(u,"px"),e.$danmuku.style.top="".concat(c,"px")}n&&(n=!1)})),this.$headR.addEventListener("click",(function(){e.$danmuku.style.display="none",e.$icon.style.display="block"})),this.$icon.addEventListener("click",(function(){e.$danmuku.style.display="block",e.$icon.style.display="none"}))}},{key:"addDanmu",value:function(e){var t=this,n=this.$danmuInner.children;if(n.length>50){var i=n[0];s(".blh-danmu-uname",i).innerText="".concat(e.uname,":"),s(".blh-danmu-text",i).innerText=e.text,this.$danmuInner.appendChild(i)}else this.$danmuInner.insertAdjacentHTML("beforeend",'\n                <div class="blh-danmu-item">\n                    <span class="blh-danmu-uname">'.concat(e.uname,':</span>\n                    <span class="blh-danmu-text">').concat(e.text,"</span>\n                </div>\n            "));this.isHover||(clearTimeout(this.danmuTimer),this.danmuTimer=setTimeout((function(){t.$danmu.scrollTo(0,t.$danmu.scrollHeight)}),100))}},{key:"addGift",value:function(e){var t=this,n=this.$giftInner.children;if(n.length>50){var i=n[0];s(".blh-gift-uname",i).innerText="".concat(e.uname,":"),s(".blh-gift-text",i).innerText="".concat(e.action," ").concat(e.gift," X ").concat(e.num),this.$giftInner.appendChild(i)}else this.$giftInner.insertAdjacentHTML("beforeend",'\n                <div class="blh-gift-item">\n                    <span class="blh-gift-uname">'.concat(e.uname,':</span>\n                    <span class="blh-gift-text">').concat(e.action," ").concat(e.gift," X ").concat(e.num,"</span>\n                </div>\n            "));this.isHover||(clearTimeout(this.giftTimer),this.giftTimer=setTimeout((function(){t.$gift.scrollTo(0,t.$gift.scrollHeight)}),100))}}]),n}())}();
